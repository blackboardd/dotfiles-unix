alias firefox=false
alias gs=false
alias gm=false
alias vi=false
alias rm="trash-put"

abbr --quiet -S firefox="firefox-nightly"
abbr --quiet -S fk='fuck'
abbr --quiet -S gimmekeys='xmodmap -e "clear lock" && setxkbmap -option ctrl:nocaps && setxkbmap -option caps:escape && xmodmap $HOME/.Xmodmap'
abbr --quiet -S tz='sudo ntpd -qg'

# automt automatically mounts all available drives
abbr --quiet -S automt='sudo mount -a'
abbr --quiet -S lsc="colorls"

function commit() {
    hash=$2
    route=$1
    echo "https://github.com/$route/commit/$hash"
}

function whatport() {
    sudo lsof -i :$1
}

# recursively replace line in all files
function recrep() {
    FROM=$1
    TO=$2
    EXT=$3

    if [ "$ext" = "" ]; then
        find . -type f -print0 | xargs -0 sed -i '' -e "s/$FROM/$TO/g"
    else
        find . -type f -name "*.$ext" -print0 | xargs -0 sed -i '' -e "s/$FROM/$TO/g"
    fi
}

function catless() {
    output=$(cat $1)
    nvim_commands=()

    filename=$(echo $1 | sed -E 's/ /_/g' | sed -E 's/[^a-zA-Z0-9_\-\.]//g')
    hash=$(date +%s%3N | base64)

    ext=$(echo "$filename" | rev | cut -d'.' -f1 | rev)

    if [ "$ext" = "json" ]; then
        output=$($output | jq .)
    fi

    mkdir -p ~/.nvim-less-cache/"$hash"
    echo "$output" > ~/.nvim-less-cache/"$hash"/"$filename"
    nvim_commands+=(nvim -R ~/.nvim-less-cache/"$hash"/"$filename")


    if [[ "$filename" == diff* ]]; then
        nvim_commands+=(-c "'set filetype=diff'")
    fi

    eval "${nvim_commands[@]}"
}

abbr --quiet -S slackt="slack-term -config ~/.slack"
abbr --quiet -S mutt="neomutt"
abbr --quiet -S sl="ls"
alias vi=nvim

function move_to_config_env {
  if [ "$1" = "on" ]; then
    export GIT_DIR=$HOME/.cfg
    export GIT_WORK_TREE=$HOME
    return
  fi

  if [ "$1" = "off" ]; then
    export GIT_DIR=
    export GIT_WORK_TREE=
    return
  fi
}

abbr --quiet -S "cfg"="move_to_config_env"

abbr --quiet -S clip="clip.exe"
abbr --quiet -S v4l2reset="sudo rmmod v4l2loopback"

bindkey " " abbr-expand-and-space
